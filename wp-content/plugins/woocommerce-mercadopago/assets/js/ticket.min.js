!function(e){"use strict";e((function(){var o=!1,t=wc_mercadopago_ticket_params.site_id,r={discount_action_url:wc_mercadopago_ticket_params.discount_action_url,payer_email:wc_mercadopago_ticket_params.payer_email,activated:wc_mercadopago_ticket_params.coupon_mode,status:!1};function c(){return!document.getElementById("payment_method_woo-mercado-pago-ticket").checked||("MLB"===t?(function(){for(var e=document.querySelector("#mercadopago-form-ticket"),o=e.querySelectorAll("[data-checkout]"),t=e.querySelectorAll(".mp-erro_febraban"),r=0;r<o.length;r++){var c=o[r],n=e.querySelector(t[r].getAttribute("data-main"));"none"===c.parentNode.style.display||-1!==c.value&&""!==c.value?(t[r].style.display="none",n.classList.remove("mp-form-control-error")):(t[r].style.display="inline-block",n.classList.add("mp-form-control-error"))}for(var u=0;u<o.length;u++){var a=o[u];if("none"!==a.parentNode.style.display&&(-1===a.value||""===a.value))return a.focus(),!1}return!0}()&&n()?o=!0:u(),o):"MLU"===t?(n()?o=!0:u(),o):void 0)}function n(){var e=document.getElementById("mp_doc_number"),o=document.getElementById("mp_error_docnumber"),r=!1;return"MLB"===t&&(r=function(e){if("CPF"==(document.getElementById("mp_cpf_cnpj_label").innerText.includes("CPF")?"CPF":"CNPJ"))return function(e){var o,t;if(o=0,"00000000000"===(e=e.replace(/[.-\s]/g,"")))return!1;for(var r=1;r<=9;r++)o+=parseInt(e.substring(r-1,r),10)*(11-r);10!=(t=10*o%11)&&11!==t||(t=0);if(t!==parseInt(e.substring(9,10),10))return!1;o=0;for(var c=1;c<=10;c++)o+=parseInt(e.substring(c-1,c),10)*(12-c);10!=(t=10*o%11)&&11!==t||(t=0);if(t!==parseInt(e.substring(10,11),10))return!1;return!0}(e);return function(e){if(""===(e=e.replace(/[^\d]+/g,"")))return!1;if(14!==e.length)return!1;if("00000000000000"===e||"11111111111111"===e||"22222222222222"===e||"33333333333333"===e||"44444444444444"===e||"55555555555555"===e||"66666666666666"===e||"77777777777777"===e||"88888888888888"===e||"99999999999999"===e)return!1;for(var o=e.length-2,t=e.substring(0,o),r=e.substring(o),c=0,n=o-7,u=o;u>=1;u--)c+=t.charAt(o-u)*n--,n<2&&(n=9);var a=c%11<2?0:11-c%11;if(a.toString()!==r[0])return!1;for(o+=1,t=e.substring(0,o),c=0,n=o-7,u=o;u>=1;u--)c+=t.charAt(o-u)*n--,n<2&&(n=9);if((a=c%11<2?0:11-c%11).toString()!==r[1])return!1;return!0}(e)}(e.value)),"MLU"===t&&(r=function(e){if(""!==e)return function(e){var o=0,t=0,r=0,c=e[e.length-1];if(e.length<=6)for(t=e.length;t<7;t++)e="0"+e;for(t=0;t<7;t++)o+=parseInt("2987634"[t],10)*parseInt(e[t],10)%10;r=o%10==0?0:10-o%10;return c===r.toString()}(e);return!1}(e.value)),r?(o.style.display="none",e.classList.remove("mp-form-control-error"),r=!0):(o.style.display="block",e.classList.add("mp-form-control-error"),e.focus()),r}function u(){e("form#order_review").length>0&&e(".blockOverlay").css("display","none")}function a(){document.querySelector("#mpCouponApplyedTicket").style.display="none",""===document.querySelector("#couponCodeTicket").value?(r.status=!1,document.querySelector("#mpCouponErrorTicket").style.display="block",document.querySelector("#mpCouponErrorTicket").innerHTML=wc_mercadopago_ticket_params.coupon_empty,document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#discountTicket").value=0):r.status?(r.status=!1,document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#applyCouponTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#couponCodeTicket").value="",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#discountTicket").value=0):(document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.loading+") 98% 50% no-repeat #fff",document.querySelector("#couponCodeTicket").style.border="1px solid #cecece",document.querySelector("#applyCouponTicket").disabled=!0,function(){var o=r.discount_action_url,t="?";o.indexOf("?")>=0&&(t="&");o+=t+"site_id="+wc_mercadopago_ticket_params.site_id,o+="&coupon_id="+document.querySelector("#couponCodeTicket").value,o+="&amount="+document.querySelector("#amountTicket").value,o+="&payer="+r.payer_email,e.ajax({url:o,method:"GET",timeout:5e3,error:function(){r.status=!1,document.querySelector("#mpCouponApplyedTicket").style.display="none",document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#applyCouponTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#couponCodeTicket").value="",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#discountTicket").value=0},success:function(e){200===e.status?(r.status=!0,document.querySelector("#mpCouponApplyedTicket").style.display="block",document.querySelector("#discountTicket").value=e.response.coupon_amount,document.querySelector("#mpCouponApplyedTicket").innerHTML=wc_mercadopago_ticket_params.discount_info1+" <strong>"+l(e.response.currency_id)+" "+Math.round(100*e.response.coupon_amount)/100+"</strong> "+wc_mercadopago_ticket_params.discount_info2+" "+e.response.name+".<br>"+wc_mercadopago_ticket_params.discount_info3+" <strong>"+l(e.response.currency_id)+" "+Math.round(100*document.querySelector("#amountTicket").value)/100+"</strong><br>"+wc_mercadopago_ticket_params.discount_info4+" <strong>"+l(e.response.currency_id)+" "+Math.round(100*(document.getElementById("amountTicket").value-document.getElementById("discountTicket").value))/100+"*</strong><br><i>"+wc_mercadopago_ticket_params.discount_info5+'</i><br><a href="https://api.mercadolibre.com/campaigns/'+e.response.id+'/terms_and_conditions?format_type=html" target="_blank">'+wc_mercadopago_ticket_params.discount_info6+"</a>",document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.check+") 94% 50% no-repeat #fff",document.querySelector("#couponCodeTicket").style.border="1px solid #cecece",document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.remove,document.querySelector("#campaign_idTicket").value=e.response.id,document.querySelector("#campaignTicket").value=e.response.name):(r.status=!1,document.querySelector("#mpCouponApplyedTicket").style.display="none",document.querySelector("#mpCouponErrorTicket").style.display="block",document.querySelector("#mpCouponErrorTicket").innerHTML=e.response.message,document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.error+") 94% 50% no-repeat #fff",document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#discountTicket").value=0),document.querySelector("#applyCouponTicket").disabled=!1}})}())}function l(e){return"ARS"===e?"$":"BRL"===e?"R$":"COP"===e||"CLP"===e||"MXN"===e?"$":"VEF"===e?"Bs":"PEN"===e?"S/":"UYU"===e?"$U":"$"}e("form#order_review").length>0&&"yes"===r.activated&&e("#applyCouponTicket").on("click",a),e("body").on("updated_checkout",(function(){"yes"===r.activated&&e("#applyCouponTicket").on("click",a)})),e("form.checkout").on("checkout_place_order_woo-mercado-pago-ticket",(function(){return c()})),e("form#order_review").submit((function(){return c()}))}))}(jQuery);